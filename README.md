# 本项目是一个使用 Flask 框架构建的图片分享网站

这个项目包括后端服务器代码、HTML 前端页面、CSS 样式表和 JavaScript 脚本。以下是对此项目的主要组成部分的概述：

## 后端服务器（Flask）

- **图片压缩功能**：项目提供了一个`compress_image`函数，用于将图片压缩为 WebP 格式，并保存到指定的输出路径。这个函数还包含了一个`save_as_webp`辅助函数，用于实际保存图片为 WebP 格式。
- **图片检查和压缩调度**：`check_and_compress_images`函数用于检查压缩文件夹中的每个文件是否存在对应的原图，并对新的或修改过的图片进行压缩。
- **路由和视图函数**：
  - 首页路由`/`：显示图片列表，并支持分页。
  - 图片服务路由`/image/<filename>`：提供压缩后的图片。
  - 原始图片服务路由`/original/<filename>`：提供原始图片。
- **后台任务调度**：使用`apscheduler`库，设置了一个每小时运行一次的后台任务，用于检查和压缩图片。

## 前端页面（HTML）

- **图片画廊**：使用循环渲染每张图片，并为每张图片提供一个牛顿摆动画作为占位符。
- **分页导航**：提供分页功能，允许用户浏览不同的图片页面。
- **全屏图片显示**：点击图片后，可以全屏查看图片，并提供下载链接。

## CSS 样式表

- **图片画廊样式**：定义了图片画廊的布局和样式。
- **响应式设计**：为不同屏幕尺寸提供了不同的样式规则。
- **全屏图片模态框样式**：定义了全屏图片显示的样式。

## JavaScript 脚本

- **懒加载实现**：使用 Intersection Observer API 实现图片的懒加载。
- **分页事件处理**：处理分页链接的点击事件，更新当前页面状态。
- **全屏图片功能**：提供打开和关闭全屏图片显示的功能。

本代码包为本项目重构前最后一个源码包，版本号：beta 0.3.0 ，后面本项目的css，html部分（尤其是css）将重构，以让网站页面换上新的更好看的布局，敬请期待！

本代码包附带了一张背景图片，位于`/static/background/`中
如需自定义可以将新图片的名字改为和现在一样
也可以到`/static/css/`中修改css的这个部分：

```css
/* 设置背景图片 */
body {
    background-image: url('/static/background/leaves.webp');      /* background/后的文件名 */
}
```
修改成实际图片的名字即可。

网页上要展示的图片放在  /static/images/  中。
启动后端前需留心有没有pip安装了需要的库：
1. Flask：用于创建Web应用。
2. Pillow（PIL的更新分支）：用于图像处理。
3. APScheduler：用于后台任务调度。

第一次开启会初始化一段时间，此时Pillow正在按预设压缩图片，保存在：  
/static/compressed_images/  中。

随后即可从  127.0.0.1/localhost:5000  ，公网（单ipv4）访问。
